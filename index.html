<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta name="generator" content="HTML Tidy for HTML5 for Linux version 5.1.25">
  <meta charset="UTF-8">
  <title>Obdi-rsyncbackup by mclarkson</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
  <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  <script src="http://api.html5media.info/1.1.8/html5media.min.js"></script>
</head>
<body>

  <section class="page-header">
    <h1 class="project-name">Obdi-rsyncbackup</h1>
    <h2 class="project-tagline">Obdi plugin to do rsync backups with compression, deduplication and snapshotting using
    zfs.</h2>
    <a href="https://github.com/mclarkson/obdi-rsyncbackup" class="btn">View on GitHub</a>
    <a href="http://nettools.obdi.io" class="btn">Parent Repository</a>
    <a href="http://obdi.io" class="btn">Obdi Home Page</a>
  </section>

  <section class="main-content">

    <style>
    img[alt=screenshot] {
        display: block;
        margin-left: auto;
        margin-right: auto;
        width: 100%;
    }
    img[alt=smallscreenshot] {
        display: block;
        margin-left: auto;
        margin-right: auto;
        width: 500px;
    }
    </style>

    <p><img src="doc/rsyncbackup_files_small.png?raw=true" alt="smallscreenshot"></p>

    <h1><a id="contents" class="anchor" href="#contents" aria-hidden="true"></a>
        Contents</h1>

    <ul>
      <li><a href="#whentouse">When to Use?</a></li>
      <li><a href="#screenshots">Screenshots</a>
        <ul>
          <li><a href="#backingup">Backing Up</a></li>
          <li><a href="#instancecreation">Amazon AWS EC2 Instance Creation</a></li>
        </ul>
      </li>
      <li><a href="#installation">Installation</a><br/>
        <p style="color:red">!! IN PROGRESS !!</p>
        <ul>
          <li><a href="#installtut">Installation Tutorial</a></li>
          <li><a href="#creatersync">Create the rsync backup server</a>
            <ul>
              <li><a href="#createsrv">Create a server and install Obdi</a>
            </ul>
          </li>
          <li><a href="#configsys">Configure the system</a></li>
          <!--
          <li><a href="#enablelift">Enable Lift and Shift</a></li>
          -->
        </ul>
      </li>
    </ul>

    <h1><a id="whentouse" class="anchor" href="#whentouse" aria-hidden="true"></a>
        When to Use?
        <sup style="font-size:small"><a href="#contents">BACK TO TOP</a></sup>
    </h1>

    <p>The following paragraph describes the specific use case this plugin was
    created for.</p>

    <p><strong>We have 80 Centos 6 servers that need to be backed up. We want
    to back up these servers efficiently and be able to create an Amazon
    EC2 AMI or Instance from the backup files so that we can 'lift and
    shift' servers into AWS.</strong></p>

    <p>So, if you have 2 servers, 20 servers or 100 servers, and they are all
    running Centos 6, then this might be a decent backup solution for you.</p>

    <p>The main features:</p>
    <ul>
        <li>Linux only solution - currently ONLY Centos 6 is supported.
            <ul>
                <li>! Help Required ! - Centos 7 should be fairly straight-forward to add.</li>
            </ul>
        </li>
        <li>By using Obdi, everything is scriptable.</li>
        <li>Efficient back up:
            <ul>
                <li>Rsync is used to efficiently back up servers.</li>
                <li>Rsyncd is set up on every server.</li>
                <li>On the backup server:
                    <ul>
                        <li>The ZFS filesystem is used to give us:
                            <ul>
                                <li>File deduplication - so identical files on many servers are only stored once.</li>
                                <li>File compression - Uncompressed files are compressed to save space.</li>
                                <li>Snapshots in time - Daily or multiple snapshots per day can be taken.</li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>Consistent Backups:
            <ol>
                <li>An initial rsync is run.</li>
                <li>Most processes on the target server are paused.</li>
                <li>Another rsync is run.</li>
                <li>Another rsync is run - just for fun.</li>
                <li>The processes are unpaused.</li>
            </ol>
        </li>
        <li>Amazon EC2 AMI or Instance creation:
            <ul>
                <li>Created from existing backups and snapshots.</li>
                <li>Implemented using two other plugins:
                    <ul>
                        <li><a href="https://github.com/mclarkson/obdi-aws-p2ec2">obdi-aws-p2ec2</a>
                        and,</li>
                        <li><a href="https://github.com/mclarkson/obdi-aws-ec2lib">obdi-aws-ec2lib</a>
                        </li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>

    <p>Obdi-rsyncbackup, a plugin for the free and Open Source <a
    href="https://github.com/mclarkson/obdi">Obdi</a>, was the answer to
    this problem. It allowed us to back up 80 physical servers with a calendar
    month's worth of daily snapshots in under 2 TB of storage. Backups
    generally complete within 2-3 hours.</p>

    <!-- SCREENSHOTS -->

    <h1><a id="screenshots" class="anchor" href="#screenshots" aria-hidden="true"></a>
        Screenshots
        <sup style="font-size:small"><a href="#contents">BACK TO TOP</a></sup>
    </h1>

    <h2><a id="backingup" class="anchor" href="#backingup" aria-hidden="true"></a>
        Backing Up
        <sup style="font-size:small"><a href="#contents">BACK TO TOP</a></sup>
    </h2>

    <p><strong>Choose Environment</strong></p>
    <p>The first step is to choose the environment. There can be many each with
    their own backup servers, or sharing the same backup servers.</p>

    <p><img src="doc/rsyncbackup_envchoice.png?raw=true" alt="screenshot"></p>

    <p><strong>Backup Tasks</strong></p>
    <p>When 'Show Backup Tasks' has been clicked on the Backup Tasks will be
    shown. There can be zero or more tasks. The 'RSYNCBACKUP_WORKER_1' worker
    definition is configured by the Obdi Administrator in the Admin interface.
    Each environment will have a 'RSYNCBACKUP_WORKER_1' definition that can
    be the same, or different, which points to a backup server.</p>

    <p>The Action items, from left to right, are:</p>
    <ul>
        <li>Delete Backup Task</li>
        <li>View Files and Snapshots</li>
        <li>Edit Backup Task</li>
        <li>Settings</li>
        <li>Includes and Excludes</li>
        <li>Run a full backup now</li>
    </ul>

    <p><img src="doc/rsyncbackup_main.png?raw=true" alt="screenshot"></p>

    <p><strong>Settings</strong></p>
    <p>All available settings are shown. Each underlined item in the
    screenshot provides documentation of the setting when the user hovers
    over that item.</p>

    <p><img src="doc/rsyncbackup_settings.png?raw=true" alt="screenshot"></p>

    <p><strong>Files and Snapshots</strong></p>
    <p>The screenshot shows the output from 'zfs list'. This shows the space used
    and available in the main read/write filesystem, and the space used for each
    read-only snapshot. Each snapshot can be browsed just as the filesystem
    can be.</p>

    <p><img src="doc/rsyncbackup_snapshots.png?raw=true" alt="screenshot"></p>

    <p><strong>Directory Browser</strong></p>
    <p>Clicking the filesystem or snapshot takes the user to the Directory Browser.
    This shows the files that were backed up, and when a directory 'looks like'
    a root filesystem the green 'Create Amazon EC2 Instance' button will be
    displayed (so long as the obdi-aws-p2ec2 plugin has been installed!).</p>

    <p><img src="doc/rsyncbackup_files.png?raw=true" alt="screenshot"></p>

    <p><strong>Includes and Excludes</strong></p>
    <p>Rsync works on includes and excludes and those are shown here. The image
    shows a filtered list where the user searched for '107'. It also shows a
    single selected item, linuxserver107. The 'Backup Selected Now' button
    was pressed and the Backup request was sent to back up only that server,
    which was started as job number 5334. Clicking on the link will take the
    user to the Log output. The log output can also be viewed by clicking
    on the 'System Jobs' menu item.</p>

    <p><img src="doc/rsyncbackup_includes.png?raw=true" alt="screenshot"></p>

    <p><strong>Output Log</strong></p>
    <p>The output from rsync is shown and it can be seen that rsync was run, processes
    paused, then more rsyncing done, then processes unpaused.</p>

    <p><img src="doc/rsyncbackup_log.png?raw=true" alt="screenshot"></p>

    <h2><a id="instancecreation" class="anchor" href="#instancecreation" aria-hidden="true"></a>
        Amazon AWS EC2 Instance Creation
        <sup style="font-size:small"><a href="#contents">BACK TO TOP</a></sup>
    </h2>

    <p>After pressing the green 'Create Amazon EC2 Instance' button the user will
    be taken to the instance creation pages of
    <a href="https://github.com/mclarkson/obdi-aws-p2ec2">obdi-aws-p2ec2</a>
    described next.</p>

    <p><strong>Choose AWS Region</strong></p>
    <p>Choose the AWS region - this is where the Volume, AMI or Instance will end up.</p>

    <p><img src="doc/rsyncbackup_aws_region.png?raw=true" alt="screenshot"></p>

    <p><strong>List Instances</strong></p>
    <p>A filtered list of instances will be shown when the 'List Instances' button
    is pressed. The filter is set by the Obdi Administrator and might be the user
    or group's key name. The list of instances is shown just for the user to verify
    that this is where they want the Volume, AMI or Instance to be put. A yellow
    background in the list means the instance is stopped and a red background means
    that the instance was terminated.</p>

    <p><img src="doc/rsyncbackup_aws_list.png?raw=true" alt="screenshot"></p>

    <p><strong>Create Instance Page</strong></p>
    <p>The user can modify some machine parameters and once the user is happy
    that the end location is correct then instance creation can start.</p>

    <p><img src="doc/rsyncbackup_aws_create1.png?raw=true" alt="screenshot"></p>

    <p><strong>Create Instance - Lift and Shift</strong></p>
    <p>The instance is created. In this case the AMI is saved and the Instance
    created, but the Volume is deleted to save space and to avoid extra costs.</p>

    <p><img src="doc/rsyncbackup_aws_create2.png?raw=true" alt="screenshot"></p>
    <p>Best case: A small machine, under 5GB in size, can be created in under 10 minutes.
    Worst case: A larger machine, over 100GB in size - and in a different region to the
    Obdi worker (requiring an extra copy) can take more than 2 hours to create.</p>

    <!-- INSTALLATION -->

    <h1><a id="installation" class="anchor" href="#installation" aria-hidden="true"></a>
        Installation
        <sup style="font-size:small"><a href="#contents">BACK TO TOP</a></sup>
    </h1>

    <!--
    <h2><a id="obdi-rsyncbackup" class="anchor" href="#obdi-rsyncbackup" aria-hidden="true"></a>
        Backing Up</h2>
    -->

    <!-- OVERVIEW -->

    <p>To make all of this work requires a few components:</p>
    <ul>
        <li>A backup server - A machine that holds the backup files.
            <ul>
                <li>This machine will have an <samp>obdi-worker</samp>
                    installed on it.</li> <li>It can be a virtual machine in
                    Amazon, or a physical/virtual machine on the local network.
                    This machine might need to have alot of memory to work
                    optimally when deduplication is enabled.</li>
            </ul>
        </li>
        <li>An Obdi Master server
            <ul>
                <li>This could be an existing machine with Obdi installed on
                    it, or a new one.</li>
                <li>The Obdi Master could be installed on the backup
                    server.</li>
                <li>It could be a virtual machine in Amazon, or
                    a physical or virtual machine on the local network.</li>
            </ul>
        </li>
        <li>Extra configuration on <em>every</em> machine that needs to be
            backed up. They must have <code>rsyncd</code> and
            <code>xinetd</code> installed and configured. (This is not
            strictly true. Rsync + ssh could be used instead but setting
            that up is not covered here.)
        </li>
    </ul>

    <p>The installation tutorial, up next, will take you through the steps
    required to set up a single server backup solution.  This is the easiest to
    set up.</p>

    <!-- INSTALLATION TUTORIAL -->

    <h2><a id="installtut" class="anchor" href="#installtut" aria-hidden="true"></a>
        Installation Tutorial
        <sup style="font-size:small"><a href="#contents">BACK TO TOP</a></sup>
    </h2>

    <p>As mentioned above, this tutorial will show you how to set up a
    single server backup solution. The backup server can be placed in the
    corporate network or in Amazon EC2.</p>

    <p><strong>Overview</strong></p>
    <p>We will do the installation in two stages. First we will set up
    the rsync backup server and make sure it works. Then we will modify
    the configuration for lift-and-shift.</p>

    <p>Installation consists of the following broad steps:</p>
    <ul>
      <li>Create the rsync backup server.
        <ol>
          <li>Create a server and install Obdi:</li>
          <li>Set up zfs etc.</li>
          <li>Configure the system:
            <ul>
              <li>Create users etc.</li>
            </ul>
          </li>
          <li>Install Obdi plugins.
          </li>
          <li>Test the User Interface
          </li>
        </ol>
      </li>
      <li>Enable Lift and Shift.
        <ol>
          <li>Install extra Obdi plugins.
          </li>
          <li>Configure the system:
            <ul>
              <li>Modify capabilities etc.</li>
            </ul>
          </li>
        </ol>
      </li>
    </ul>

    <p>We'll start the installation next...</p>

    <!-- Create the rsync backup server -->

    <h2><a id="creatersync" class="anchor" href="#creatersync" aria-hidden="true"></a>
        Create the rsync backup server
        <sup style="font-size:small"><a href="#contents">BACK TO TOP</a></sup>
    </h2>

    <p>In this section we will cover the first bullet point, creating the
    rsync backup server.</p>

    <!-- Create a server and install Obdi -->

    <h3><a id="createsrv" class="anchor" href="#createsrv" aria-hidden="true"></a>
        Create a server and install Obdi
        <sup style="font-size:small"><a href="#contents">BACK TO TOP</a></sup>
    </h3>
    <p>Creating a server and installing Obdi is already documented on
    on the obdi.io main page.</p>
    <p>So, head over to the <a target="_blank"
      href="http://obdi.io/#installation">Obdi Installation</a> section,
    complete the instructions there, then continue from here. The link
    should open in a new window so that you won't lose your place.</p>

    <!-- Create a server and install Obdi -->

    <h3><a id="createsrv" class="anchor" href="#createsrv" aria-hidden="true"></a>
        Set up zfs etc.
        <sup style="font-size:small"><a href="#contents">BACK TO TOP</a></sup>
    </h3>

    <p><strong>NOTE</strong>: A new volume should be created that will be
    mounted on <code>/backup</code>. It could be an LVM Volume, a physical disk
    or an Amazon Volume depending on the platform it is running on. This volume
    will probably be quite large and will be set up with the zfs
    filesystem.</p>

    <p><strong>Steps for Centos 6/7:</strong></p>

    <p>Install zfs from <a href="https://github.com/zfsonlinux/zfs/wiki/RHEL-%26-CentOS">The Official ZFS pages</a>.</p>

    <p>The following example creates a partition table on <code>/dev/xvdb</code> - a 3TB
    Amazon volume created and attached by the administrator - then creates the zfs
    filesystem:</p>

<pre>
# Become root
sudo su

# Load the module that was built earlier
modprobe zfs

# Make the root of the backup tree
mkdir /backup

# Create a partition on /dev/xvdb1 using parted
echo -e "mktable gpt\nmkpart\n\n\n0%\n100%\nprint\nq" | parted /dev/xvdb

# Create a zpool
zpool create backup /dev/xvdb1

# Switch on deduplication and compression.
# Note: dedup needs a large amount of memory.
zfs create -o dedup=on -o compression=gzip backup/servers-zfs

# Disable atime
zfs set atime=off backup/servers-zfs

# List and check settings
zfs list
zpool list
zfs get dedup
zfs get compression
zfs get atime
</pre>

    <!-- Configure the system -->

    <h3><a id="configsys" class="anchor" href="#configsys" aria-hidden="true"></a>
        Configure the system
        <sup style="font-size:small"><a href="#contents">BACK TO TOP</a></sup>
    </h3>

    <p>This section <em>could</em> contain lots of screen shots with instructions
    telling you what to click on and what fields to type in using the Obdi
    Admin interface but we won't do that! Instead we'll go straight to using
    the REST api to demonstrate the versatility gained by using REST for
    everything. Anything that can be done using the Obdi User Interface can
    always be done using REST.</p>

    <p>The following graphic shows the scenario that we will implement:</p>
    <p><img src="doc/scenario1.jpeg?raw=true" alt="screenshot"></p>
    <p>With this scenario:</p>
    <ul>
      <li>a VPN is required,</li>
      <li>the VPN will be used periodically (probably daily), and</li>
      <li>copying backup data to Amazon EC2 Volumes should be fast.</li>
    </ul>

    <p><strong>Note</strong>: You may have installed Obdi in a machine
    on the corporate network instead. This is fine, and will not affect the
    configuration, but it will have different performance characteristics
    (and you might not need the VPN).</p>

    <p>Ssh into the machine you made and configuration starts next...</p>

    <p><strong>Log in to Obdi</strong></p>
    <p>Using the default user name and password log into Obdi. By default, logins
    timeout after 10 minutes of inactivity, so if that happens just log in
    again and get a new token.</p>

<pre>
proto="https"
opts="-k -s" # don't check ssl cert, silent
ipport="127.0.0.1:443"
token=`curl $opts -d '{"Login":"admin","Password":"admin"}' \
    $proto://$ipport/api/login | grep -o "[a-z0-9][^\"]*"`

# View the token (should not be empty!)
echo "token=$token"
</pre>

    <p><strong>Create users</strong></p>

    <p>We will create a user to login with, nomen.nescio, and a user that will
    be used by the worker daemon.</p>

<pre>
curl $opts -d '{
    "login":"worker",
    "passHash":"worker",
    "forename":"Worker",
    "surname":"Daemon",
    "email":"worker@invalid",
    "MultiLogin":true,
    "enabled":true}' "$proto://$ipport/api/admin/$token/users"

curl $opts -d '{
    "login":"nomen.nescio",
    "passHash":"p4ssw0rd",
    "forename":"Nomen",
    "surname":"Nescio",
    "email":"nomen@invalid",
    "enabled":true}' "$proto://$ipport/api/admin/$token/users"
</pre>

    <p><strong>Create a datacentre and environment</strong></p>

    <p>Create a datacentre named 'AWS':</p>

<pre>
curl $opts -d '{
    "SysName":"aws",
    "DispName":"AWS"
    }' "$proto://$ipport/api/admin/$token/dcs"
</pre>

    <p>Create an environment named 'perf' in the AWS datacentre:</p>

<pre>
# Get the datacentre ID
dcid=`curl $opts "$proto://$ipport/api/admin/$token/dcs?sys_name=aws" \
      | grep Id | grep -o "[0-9]"`

# Create the env
if [[ -z $dcid ]]; then
    echo "dcid should not be empty"
else
  curl $opts -d '{
      "SysName":"perf",
      "DispName":"Performance Servers",
      "DcId":'"$dcid"',
      "WorkerUrl":"https://127.0.0.1:4443/",
      "WorkerKey":"changeme"
  }' "$proto://$ipport/api/admin/$token/envs"
fi
</pre>

    <p>Change the key setting in <code>/etc/obdi-worker/obdi-worker.conf</code>
    to whatever you set for the WorkerKey property above. Use an editor or use
    <em>sed</em>. For example, to change the key to 'changeme' using
    <em>sed</em>:</p>

<pre>
sed -ri 's/(^key\s*=\s*).*/\1"changeme"/' /etc/obdi-worker/obdi-worker.conf
</pre>

    <p><strong>Assign permissions</strong></p>

    <p>Give the 'Enabled' and 'Writeable' permissions to the user, nomen.nescio.</p>

    <p>A <em>bash</em> function, 'edit_perm', is defined then used to edit the
    permission:</p>

<pre>
# Add the bash function, edit_perm:

edit_perm()
# Parameters:
# $1 - login (text)
# $2 - data centre (text)
# $3 - environment (text)
# $4 - Enabled (true|false)
# $5 - Writeable (true|false)
{
    userid=`curl $opts "$proto://$ipport/api/admin/$token/users?login=$1" | grep Id | grep -o "[0-9]"`
    dcid=`curl $opts "$proto://$ipport/api/admin/$token/dcs?sys_name=$2" | grep Id | grep -o "[0-9]"`
    envid=`curl $opts "$proto://$ipport/api/admin/$token/envs?sys_name=$3&dc_id=$dcid" | grep -w Id | grep -o "[0-9]"`

    echo
    echo "$1 $2 $3 $4 $5"
    echo curl $opts -d '{
        "UserId":'"$userid"',
        "EnvId":'"$envid"',
        "Enabled":true,
        "Writeable":true
    }' "$proto://$ipport/api/admin/$token/perms"

    curl $opts -d '{
        "UserId":'"$userid"',
        "EnvId":'"$envid"',
        "Enabled":'"$4"',
        "Writeable":'"$5"'
    }' "$proto://$ipport/api/admin/$token/perms"
}

# Use edit_perm to change permissions

edit_perm nomen.nescio aws perf true true
</pre>

    <h3><a id="installplugins" class="anchor" href="#installplugins" aria-hidden="true"></a>
        Install Obdi plugins:
        <sup style="font-size:small"><a href="#contents">BACK TO TOP</a></sup>
    </h3>

    <p>Add the plugin repositories and install the plugins. We'll install
    the Job Viewer, <em>nettools</em>, and <em>rsyncbackup</em>.</p>

<pre>
# Obdi core repo

curl $opts -d '{
    "Url":"https://github.com/mclarkson/obdi-core-repository.git"
}' "$proto://$ipport/api/admin/$token/repos"

# systemjobs plugin

curl $opts -d '{
    "Name":"systemjobs"
}' "$proto://$ipport/api/admin/$token/repoplugins"

# nettools repo

curl $opts -d '{
    "Url":"https://github.com/mclarkson/obdi-nettools-repository.git"
}' "$proto://$ipport/api/admin/$token/repos"

# nettools plugin

curl $opts -d '{
    "Name":"nettools"
}' "$proto://$ipport/api/admin/$token/repoplugins"

# rsyncbackup plugin
# This could take quite some time since it compiles 10 Go source files.

curl $opts -d '{
    "Name":"rsyncbackup"
}' "$proto://$ipport/api/admin/$token/repoplugins"
</pre>

    <h3><a id="testui" class="anchor" href="#testui" aria-hidden="true"></a>
        Test the User Interface
        <sup style="font-size:small"><a href="#contents">BACK TO TOP</a></sup>
    </h3>

    <p>Connect to the Obdi Admin inteface using a Web Browser at
    'https://OBDI_IP/manager/admin' and take a look around.</p>

    <p>Connect to the Obdi Run interface next using,
    'https://OBDI_IP/manager/run', and you will see the plugins
    that have been installed, great! You will also encounter an
    error message as shown below:</p>

    <p><img src="doc/rsyncbackup_errormsg1.png?raw=true" alt="smallscreenshot"></p>

    <p>The error message is: "Server said: Plugin endpoint 'rsyncbackup/tasks'
    does not exist. Compile failed for
    '/usr/lib/obdi/plugins/rsyncbackup/tasks'. System said 'exit status 2'.
    STDOUT: STDERR: go: cannot find GOROOT directory: /usr/local/go".</p>

    <p>The Go (golang) plugins are compiled when they are needed and the
    error message is due to a misconfiguration. To fix it, the 'go_root'
    variable needs correcting. The following command will fix this:</p>

<pre>
# Modify /etc/obdi/obdi.conf

sed -ri 's#(^go_root\s*=\s*).*#\1"'"`go env GOROOT`"'"#' /etc/obdi/obdi.conf

# Restart obdi

service obdi restart 
service obdi-worker restart
</pre>

    <p>Now you will be able to click the 'Add Backup Task' button and start
    configuring the backup tasks.</p>

    <h2><a id="installation" class="anchor" href="#installation" aria-hidden="true"></a>
        Enable Lift and Shift
        <sup style="font-size:small"><a href="#contents">BACK TO TOP</a></sup>
    </h2>

    <p><strong>Install extra Obdi plugins</strong></p>

    <p><strong>Configure the system</strong></p>

    <p>If you look at the logs you will see:</p>

    <p><img src="doc/rsyncbackup_errormsg2.png?raw=true" alt="smallscreenshot"></p>

    <p>So we need the user, 'sduser' (the secret data user). Lets add it:</p>

<pre>
curl $opts -d '{
    "login":"sduser",
    "passHash":"webfkaalwiugfasf",
    "forename":"Secret Data",
    "surname":"User",
    "email":"sduser@invalid",
    "MultiLogin":false,
    "enabled":true}' "$proto://$ipport/api/admin/$token/users"
</pre>

    <!--
    <video src="doc/test1.webm" style="width: 100%" controls preload></video>
    -->

    <!-- FOOTER -->

    <p>&nbsp;</p>
    <footer class="site-footer">
      <span class="site-footer-owner"><a href="https://github.com/mclarkson/obdi-rsyncbackup">Obdi-rsyncbackup</a> is
      maintained by <a href="https://github.com/mclarkson">mclarkson</a>.</span> <span class="site-footer-credits">This
      page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href=
      "https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason
      Long</a>.</span>
    </footer>
  </section>

</body>
</html>
